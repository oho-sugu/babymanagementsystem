window.ccchart=(function(a){return{aboutThis:{version:"1.06.12",update:20131005,updateMemo:"http://ccchart.com/update.json",lisence:"MIT (later v1.x+ MIT, before v0.9x- Public Domain)",memo:"This is a Simple JavaScript chart that does not depend on libraries such as jQuery or google APIs.",demoCurrent:"http://ccchart.com/",demoDevelopment:"http://ccchart.org/",demo09xbefore:"http://ccchart.com/c/",writer:"Toshiro Takahashi @toshirot",see:"http://www.facebook.com/javascripting",branched:"This project has branched from the jQchart, that made by Toshiro TakahashijQchart is the jQuery plugin. since 2007.http://archive.plugins.jquery.com/project/jQchart",module:[]},m:[],init:function c(l,k,j){this.drawing=false;if((""+l.nodeName).toLowerCase()==="canvas"){this.canvas=l;this.id=l.id}else{this.canvas=document.getElementById(l);this.id=l}if(typeof this.ids!=="object"){this.ids=[];this.cxs=[];this.ops=[];this.gcf=this.gcf||{};this.wses=[];this.wsuids=[];this.wsReCnt=[];this.idsLen=0;this.maxZindex=0;this.moveDly=0;this.moveStack=[];this.moveStackDly=[];this.cssgs=[];this.cssTooltips=[];for(var f in a.ccchart.m){var d=!!f;break}if(d){for(var f in this.m){this.extend(this.m[f])}}}this.callback=j;this.idsLen++;this.canvas.setAttribute("class","-ccchart");this.ids[this.id]=this.canvas;this.ctx=this.cxs[this.id]=this.canvas.getContext("2d");if(!k.data){k.data=k.data||[[""],[""]]}this.ops[this.id]=this.ops[this.id]||[];if(a.ccchart._added_unloadEvent!=="on"){a.addEventListener("unload",function(){a.ccchart=null});a.ccchart._added_unloadEvent="on"}if(!this.adds){this.adds=[];this.adds.push([l,k,j])}var g=document.getElementById("-ccchart-css-hybrid");if(g){var e=document.getElementById("-ccchart-css-groupbox");var h=document.getElementById("-ccchart-css-group-"+this.id);if(e&&h){e.removeChild(h)}}this.loadBranch(k,j);return this},preProcessing:function(h,m){if(!h){h={}}if(!this.gcf){this.gcf={}}if(!h.config){h.config={}}this.op=h;this.width=h.config.width||this.gcf.width||600;this.height=h.config.height||this.gcf.height||400;this.bg=h.config.bg||this.gcf.bg||"";this.bgGradient=h.config.bgGradient||this.gcf.bgGradien||"";if(this.bgGradient===""&&this.bg===""){this.bgGradient={direction:"vertical",from:"#687478",to:"#222"}}this.type=h.config.type||this.gcf.type||"line";if((h.config.useToolTip==="yes"||this.gcf.useToolTip==="yes")&&(this.type==="bar"||this.type==="stacked")){h.config.useMarker="css-maru";this.barTipAnchorColor=this.op.config.barTipAnchorColor||this.gcf.barTipAnchorColor||"rgba(0,0,0,0.7)"}this.useToolTip=h.config.useToolTip||this.gcf.useToolTip||"no";this.useCss=h.config.useCss||this.gcf.useCss||"no";this.useMarker=h.config.useMarker||this.gcf.useMarker||"none";if(this.useMarker==="css-ring"||this.useMarker==="css-maru"){if(!(this.type==="pie")){this.useCss="yes";this.useToolTip="yes"}}else{if(this.useToolTip==="yes"){if(!(this.type==="pie")){this.useCss="yes"}this.useMarker="css-maru"}}if(this.useToolTip==="yes"){this.tmpToolTip=h.config.tmpToolTip||this.gcf.tmpToolTip}if(this.type==="pie"){this.useMarker="none"}this.markerWidth=h.config.markerWidth||this.gcf.markerWidth||this.lineWidth*2||2;if(this.useCss==="yes"){this.bind("scroll","_adjustcsspos");this.bind("load","_adjustcsspos");this.bind("resize","_adjustcsspos")}this.changeRC=h.config.changeRC||this.gcf.changeRC||"no";if(this.changeRC!=="no"){h.data=this.util.changeRowsAndCols(h.data)}this.wkdata=h.data||[];this.useFirstToColName=h.config.useFirstToColName||this.gcf.useFirstToColName;this.useFirstToColName=(this.useFirstToColName===false)?((this.type==="scatter")?true:false):true;if(this.wkdata.length===1){this.useFirstToColName=false}this.useFirstToRowName=h.config.useFirstToRowName||this.gcf.useFirstToRowName;this.useFirstToRowName=(this.useFirstToRowName===false)?false:true;this.colNames=(this.useFirstToColName)?this.wkdata.slice(0,1)[0]:"";this.data=(this.useFirstToColName)?this.wkdata.slice(1):this.wkdata;this.rowNames=[];if(this.useFirstToRowName){this.data=[];this.colNamesTitle=this.colNames.slice(0,1)[0]||"";this.colNames=this.colNames.slice(1);for(var f=1;f<this.wkdata.length;f++){this.rowNames.push(this.wkdata[f][0]);this.data.push(this.wkdata[f].slice(1))}}this.hanreiNames=this.rowNames;this.useRow0thToHanrei=h.config.useRow0thToHanrei||this.gcf.useRow0thToHanrei||"none";if(this.type==="scatter"){this.colNamesTitle=this.rowNames[0]||"";this.rowNamesTitle=this.rowNames[1]||"";if(this.useRow0thToHanrei==="yes"){this.hanreiNames=""}else{this.hanreiNames=this.util.uniq(this.colNames.slice(1))}}this.dataRowLen=this.data.length;this.dataColLen=this.data[0].length;this.maxWsColLen=this.op.config.maxWsColLen||this.gcf.maxWsColLen||10;this.wsDbg=this.op.config.wsDbg||false;this.wsInfo=this.op.config.wsInfo||false;this.wsThrowData=this.op.config.wsThrowData||this.gcf.wsThrowData||false;this.maxDelayMS=this.op.config.maxDelayMS||this.gcf.maxDelayMS||100;var d=[];for(var f=0;f<this.data.length;f++){d[f]=[];for(var e=0;e<this.data[f].length;e++){d[f][e]=parseFloat((""+this.data[f][e]).split(",").join("")||0)}}this.data=d;this.yScalePercent=this.op.config.yScalePercent||this.gcf.yScalePercent||"no";if((this.type==="stacked%"||this.type==="pie")&&this.op.config.percentVal!="no"){this.op.config.percentVal="yes"}this.percentVal=this.op.config.percentVal||this.gcf.percentVal||"no";this.title=h.config.title||this.gcf.title||"";this.subtitle=h.config.subtitle||h.config.subTitle||this.gcf.subTitle||"";this.canvas.setAttribute("title",this.title);this.onlyChart=h.config.onlyChart||this.gcf.onlyChart||"no";this.onlyChartWidthTitle=h.config.onlyChartWidthTitle||this.gcf.onlyChartWidthTitle||"no";this.paddingDefault=h.config.paddingDefault||this.gcf.paddingDefault||10;if(this.onlyChartWidthTitle==="yes"){this.paddingBottomDefault=this.paddingLeftDefault=this.paddingRightDefault=this.paddingDefault;this.paddingTopDefault=90;this.onlyChart="yes"}else{if(this.onlyChart==="yes"){this.paddingTopDefault=this.paddingBottomDefault=this.paddingLeftDefault=this.paddingRightDefault=this.paddingDefault}else{this.paddingTopDefault=90;if(this.title===""&&this.adds.length===1){this.paddingTopDefault=this.paddingTopDefault-30}if(this.subtitle===""&&this.adds.length===1){this.paddingTopDefault=this.paddingTopDefault-15}this.paddingBottomDefault=40;this.paddingLeftDefault=110;if(this.yScalePercent==="no"){this.paddingLeftDefault=70}this.paddingRightDefault=120}}if(this.adds.length>=2){this.paddingRightDefault=160}this.useVal=h.config.useVal||this.gcf.useVal||"no";if(this.type==="stacked%"&&this.useVal==="yes"){this.paddingTopDefault=90}this.paddingTop=h.config.paddingTop||this.gcf.paddingTop||this.paddingTopDefault;this.paddingBottom=h.config.paddingBottom||this.gcf.paddingBottom||this.paddingBottomDefault;this.paddingLeft=h.config.paddingLeft||this.gcf.paddingLeft||this.paddingLeftDefault;this.paddingRight=h.config.paddingRight||this.gcf.paddingRight||this.paddingRightDefault;this.chartWidth=this.width-this.paddingLeft-this.paddingRight;this.chartHeight=this.height-this.paddingTop-this.paddingBottom;this.chartTop=this.paddingTop;this.chartBottom=this.height-this.paddingBottom;this.chartLeft=this.paddingLeft;this.chartRight=this.width-this.paddingRight;this.roundDigit=this.op.config.roundDigit;if(this.roundDigit===undefined){this.gcf.roundDigit}if(typeof this.roundDigit==="number"){this._useDecimal="yes";this.roundDigit=parseInt(this.roundDigit)}else{if(this.roundDigit===undefined){if(JSON.stringify(this.data).indexOf(".")!==-1){this._useDecimal="yes";this.roundDigit=3}else{this._useDecimal="no"}}else{this._useDecimal="no"}}this.xScaleDecimal=this._useDecimal;this.yScaleDecimal=this._useDecimal;this.maxY=l(this,"maxY")||0;if(this.yScaleDecimal!=="yes"){k(this,"maxY","roundedUpMaxY")}if(typeof this.op.config.axisXLen==="number"){this.axisXLen=this.op.config.axisXLen}else{if(typeof this.gcf.axisXLen==="number"){this.axisXLen=this.gcf.axisXLen}else{this.axisXLen=10;if(this.yScaleDecimal==="no"){if(this.maxY<this.axisXLen){this.axisXLen=parseInt(this.maxY)}}}}this.minY=g(this,"minY")||0;this.yGapValue=parseFloat((this.maxY-this.minY)/this.axisXLen,10);this.unitH=this.chartHeight/(this.maxY-this.minY);if(this.type==="stacked%"){this.unitH=this.chartHeight/100}this.wkYScale=this.minY;this.yGap=this.chartHeight/this.axisXLen;this.axisYLen=this.dataColLen;this.xGap=(this.chartWidth)/this.axisYLen;this.xColor=h.config.xColor||this.gcf.xColor||"rgba(180,180,180,0.3)";this.yColor=h.config.yColor||this.gcf.yColor||"rgba(180,180,180,0.3)";if(this.type==="scatter"){if(this.op.config.maxX){this.maxX=this.op.config.maxX||this.gcf.maxX}else{var n=this.util.hCopy(this.data[0]);this.maxX=n.sort(function(j,i){return i-j})[0]}k(this,"maxX","roundedUpMaxX");this.minX=this.op.config.minX||this.gcf.minX;if(typeof this.minX==="number"){this.minX=this.minX||0}else{var n=this.util.hCopy(this.data[0]);this.minX=n.sort(function(i,j){return i-j})[0]}this.axisYLen=this.op.config.axisYLen||this.gcf.axisYLen||10;this.xGap=(this.chartWidth)/this.axisYLen;this.xGapValue=parseFloat((this.maxX-this.minX)/this.axisYLen,10);this.unitW=this.chartWidth/(this.maxX-this.minX);this.wkXScale=this.minX}this.colorSet=h.config.colorSet||this.gcf.colorSet||["red","#FF9114","#3CB000","#00A8A2","#0036C0","#C328FF","#FF34C0"];this.textColor=h.config.textColor||this.gcf.textColor||false;this.textColors=h.config.textColors||this.gcf.textColors||{title:"#ccc",subTitle:"#ddd",x:"#aaa",y:"#aaa",hanrei:"#ccc",unit:"#aaa",memo:"#ccc"};if(this.textColors){this.textColors.all=this.textColors.all||undefined}else{if(this.gcf.textColors){this.textColors.all=this.gcf.textColors.all||undefined}}this.hanreiMarkerStyle=h.config.hanreiMarkerStyle||this.gcf.hanreiMarkerStyle||"arc";this.lineWidth=h.config.lineWidth||this.gcf.lineWidth||2;this.pieHoleRadius=h.config.pieHoleRadius||this.gcf.pieHoleRadius||40;this.pieRingWidth=this.op.config.pieRingWidth||this.gcf.pieRingWidth||40;this.barPadding=h.config.barPadding||this.gcf.barPadding||10;this.barWidth=h.config.barWidth||this.gcf.barWidth||10;this.barGap=h.config.barGap||this.gcf.barGap||1;this.unit=h.config.unit||this.gcf.unit||"";this.flipDirection=h.config.flipDirection||this.gcf.flipDirection||"x";this.xLines=h.config.xLines||this.gcf.xLines||"none"||[{color:"rgba(204,153,0,0.7)",width:"1",val:0,vColor:"rgba(204,153,0,0.7)",xOffset:2,yOffset:4}];this._memo=h.config.memo||this.gcf.memo||null;this._img=h.config.img||this.gcf.img||null;this.imgAlpha=h.config.imgAlpha||this.gcf.imgAlpha||1;this.useShadow=h.config.useShadow||this.gcf.useShadow||"yes";if(this.useShadow==="yes"){this.shadows=h.config.shadows||this.gcf.shadows||{hanrei:["#222",5,5,5],xline:["#444",7,7,5],line:["#222",5,5,5],bar:["#222",5,5,5],stacked:["#222",5,-5,5],stackedarea:["#222",5,5,5],bezi:["#222",5,5,5],bezi2:["#222",5,5,5],scatter:["#222",5,5,5],pie:["#444",3,3,3]};if(this.shadows){this.shadows.all=this.shadows.all||(this.gcf.shadows?this.gcf.shadows.all:undefined)||undefined}}this.ua=navigator.userAgent.toLowerCase();this.prefix=this.ua.match(/webkit/)?"-webkit":this.ua.match(/firefox/)?"-moz":this.ua.match(/opera/)?"-o":"-ms";this.pfx=[];this.setPfx("transform");this.setPfx("transform-origin");this.setPfx("transition");this.setPfx("box-sizing");this.borderWidth=h.config.borderWidth||this.gcf.borderWidth||3;this.opsLen=0;for(var f in this){this.ops[this.id][f]=this[f];this.opsLen++}this.ops[this.id].targetPos=null;if(this.useCss==="yes"){if(this.useCssSetting){this.useCssSetting(h)}}this.ondrew=m||function(){};this._ondrew=function(){this.drawing=false;if(this.useCss==="yes"){this.adjustCss("drew",this.id,this.type)}if(this.ondrew){this.ondrew(this)}};this.draw(h);function l(i,j){if(typeof h.config[j]==="undefined"||typeof h.config[j]===null||typeof h.config[j]==="none"){if(i.type==="stacked"||i.type==="stackedarea"||i.type==="stacked%"){return i.util.getMaxSum(i)}else{return i.util.getMax(i)}}else{return parseFloat(h.config[j])}}function k(o,i,j){if(o.yScalePercent==="no"){var p=Math.pow(10,(""+o[i]).split(".")[0].length-2);o[j]=(h.config[j]!==undefined)?h.config[j]:p;if(o[j]!==0){o[i]=Math.ceil(o[i]/o[j])*o[j]}else{o[i]=o[i]}}}function g(i,j){if(i.type==="line"||i.type==="bezi2"||i.type==="bezi"||i.type==="area"||i.type==="scatter"||i.type==="ampli"){if(typeof h.config[j]==="undefined"){return i.util.getMin(i)}else{return parseFloat(h.config[j])||0}}}},setPfx:function(d){return this.pfx[d]=this.prefix+"-"+d},get:function(d,h,e){var g=this;var e=(e===false)?false:true;var f=new XMLHttpRequest();f.open("GET",d,e);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.setRequestHeader("Pragma","no-cache");f.setRequestHeader("Cache-Control","no-cache");f.onreadystatechange=function(i){if(f.readyState==4&&f.status==200){if(f.responseText===""){return f}var j=decodeURIComponent(f.responseText);if(h){h(j)}}};f.send();return f},getOption:function(g,f,d){var e=this;this.get(g,function(h){try{g=JSON.parse(h);e.loadBranch(g,f)}catch(i){}},d)},getOptionCnfData:function(g,f,d){var e=this;this.get(g.config,function(h){try{g.config=JSON.parse(h);e.getOptionData(g,f,true)}catch(i){}},d)},getOptionCnf:function(g,f,d){var e=this;this.get(g.config,function(h){try{g.config=JSON.parse(h);e.preProcessing(g,f)}catch(i){}},d)},getOptionData:function(g,f,d){var e=this;this.get(g.data,function(h){try{g.data=JSON.parse(h);e.preProcessing(g,f)}catch(i){}},d)},bind:function(h,j){var g=this;var i=this.canvas;if(h==="click"||h==="touchstart"){var e=this.util.isMobile();h=(e)?"touchstart":"click"}if(typeof this.ids!=="object"){i=a}if(j!=="_adjustcsspos"){if(typeof j==="function"){i.removeEventListener(h,function(k){j.call(g,k,g.canvas)});if(h==="load"){j.call(g,a.event,g.canvas)}else{i.addEventListener(h,function(k){j.call(g,k,g.canvas)})}if(this.useCss==="yes"&&this.hybridBox){this.hybridBox.addEventListener(h,function(k){j.call(g,k,g.canvas)})}}}if(this.useCss!=="yes"){return this}else{if(h==="load"){d(this,a,"load")}if(h==="resize"){d(this,a,"resize")}if(h==="scroll"){d(this,document,"scroll")}}function f(){g.adjustCss(h)}function d(l,m,k){if(l["_added_css_"+k+"Event"]!=="on"){m.addEventListener(k,f);l["_added_css_"+k+"Event"]="on"}}return this},$:function(d){if(typeof d==="function"){this.bind("load",d)}},draw:function(d){this.drawing=true;if(this.adds.length<=2){this.canvas.width=this.width;this.canvas.height=this.height;this.ctx.scale(1,1);this.ctx.translate(0,0);this.ctx=this.util.setDefaultCtxProps(this,"font","100 12px 'Arial'");if(this.bgGradient){this.drawGradient()}else{if(this.bg){this.drawBG()}}if(this.type!=="pie"){this.drawAxisX();this.drawAxisY()}if(this.onlyChart==="no"||this.onlyChartWidthTitle==="yes"){this.drawTitle()}if(this.onlyChart==="no"){this.drawSubTitle()}}else{this.drawAxisX(this.adds.length)}if(this.onlyChart==="no"){this.drowHanrei()}if(typeof this._img==="object"){this.drawImg(this._img)}if(typeof this._memo==="object"){this.drawMemo()}if(d){this.swtGraph()}if(this.useMarker!=="none"&&this.type!=="scatter"){this.drawMarkers()}if(this.xLines!=="none"){this.drawXLine()}if(this.type==="line"&&this.useVal!=="no"){this.drawVals()}if(this.type==="area"&&this.useVal!=="no"){this.drawVals()}if(this.unit!==""){this.drawUnit(this.unit)}},swtGraph:function(){switch(this.type){case ("line"):this.drawLine();break;case ("bar"):this.drawBar();break;case ("pie"):this.drawPie();break;case ("bezi"):this.drawbeziLine();break;case ("bezi2"):this.drawbeziLine2();break;case ("stacked"):this.drawStackedBar();break;case ("area"):this.drawArea();break;case ("stackedarea"):this.drawStackedArea();break;case ("stacked%"):this.drawStackedPercent();break;case ("ampli"):this.drawAmplitude();break;case ("scatter"):this.drawScatter();break;default:this.drawBar();break}},drawBG:function(d){if(this.bg===""&&!d){return}if(this.canvas.style&&this.bg!==""){this.canvas.style.setProperty("background",(d||this.bg),"")}return this},drawGradient:function(){var f=this.bgGradient;var g=(f.direction==="vertical")?this.height:0;var d=(f.direction==="horizontal")?this.width:0;var e=this.ctx.createLinearGradient(0,0,d,g);e.addColorStop(0,f.from);e.addColorStop(1,f.to);this.ctx.fillStyle=e;this.ctx.fillRect(0,0,this.width,this.height);return this},drawAxisX:function(){this.axisXWidth=this.op.config.axisXWidth||this.gcf.axisXWidth||1;for(var e=this.chartBottom,d=0;e>=this.chartTop;e-=this.yGap,d++){if(this.adds.length<=2){this.ctx.beginPath();this.ctx.lineWidth=this.axisXWidth;this.ctx.strokeStyle=this.xColor;this.ctx.moveTo(this.chartLeft,e);this.ctx.lineTo(this.chartRight,e);this.ctx.stroke()}if(this.onlyChart==="no"){this.drawYscale(e,d)}}return this},drawAxisY:function(){this.axisYWidth=this.op.config.axisYWidth||this.gcf.axisYWidth||1;this.xScaleSkip=this.op.config.xScaleSkip||this.gcf.xScaleSkip||0;var d=this.axisYWidth;for(var f=this.chartLeft,e=0;f<=this.chartRight;f+=this.xGap,e++){if(this.xScaleSkip!==0){if(e%this.xScaleSkip===0){d=3}else{d=1}}this.ctx.beginPath();this.ctx.lineWidth=d;this.ctx.strokeStyle=this.yColor;this.ctx.moveTo(f,this.chartTop);this.ctx.lineTo(f,this.chartBottom);this.ctx.stroke();if(this.useFirstToColName&&this.onlyChart==="no"){if(this.xScaleSkip!==0){if(e%this.xScaleSkip===0){this.drawXscale(f,e)}}else{this.drawXscale(f,e)}}}return this},drawXscale:function(h,k){if(this.type!=="scatter"){if(!this.colNames[k]){return this}}this.ctx.save();var i=this.xScaleDecimal;var r=this.op.config.xScaleColor||this.gcf.xScaleColor||this.textColor||this.gcf.textColor||this.textColors.all||(this.gcf.textColors?this.gcf.textColors.all:(this.textColors.x||this.gcf.x))||"#aaa";var e=this.op.config.xScaleFont||this.gcf.xScaleFont;var f=this.op.config.xScaleAlign||this.gcf.xScaleAlign||"center";var n=this.op.config.xScaleXOffset||this.gcf.xScaleXOffset||0;var j=this.op.config.xScaleYOffset||this.gcf.xScaleYOffset||22;var m=this.op.config.colNamesTitleOffset||this.gcf.colNamesTitleOffset||22;if(this.type==="scatter"){m+=this.xGap/2}var d=this.op.config.xScaleRotate||this.gcf.xScaleRotate||0;if(this.type==="scatter"){var g="",l="";if(h>=this.chartRight){this.wkXScale=this.maxX}g=this.util.addComma(this,this.wkXScale,i);l=(this.xScalePercent==="yes")?(" ("+k*10+"%)"):"";this.wkXScaleStr=g+l}var q=(this.type==="scatter")?0:this.xGap/2-n;if(e){this.ctx.font=e}if(this.type!=="pie"){var g=(this.type==="scatter")?this.wkXScaleStr:this.colNames[k];this.ctx.save();this.ctx.textAlign=f;this.ctx.fillStyle=r;this.ctx.translate(h+q,this.chartBottom+j);this.ctx.rotate(d*2*Math.PI/360);this.ctx.fillText(g,0,0);this.ctx.restore()}if(k===0){var s=(this.colNamesTitle==="")?"":"("+this.colNamesTitle+")";var p=this.chartRight+m;var o=this.chartBottom+j;if(this.type!=="scatter"){this.ctx.fillText(s,p,o)}}else{this.drawMemo({val:s,left:this.chartLeft+(this.chartRight-this.chartLeft)/2,top:o+15,align:"center",color:r,font:e})}if(this.type==="scatter"){this.wkXScale=parseFloat(this.wkXScale);this.wkXScale+=this.xGapValue}this.ctx.restore();return this},drawYscale:function(l,h){this.ctx.save();var m=this.yScaleDecimal;var g=this.op.config.yScaleColor||this.gcf.yScaleColor||this.textColor||this.textColors.all||this.textColors.y||"#aaa";var e=this.op.config.yScaleFont||this.gcf.yScaleFont;var o=this.op.config.yScaleAlign||this.gcf.yScaleAlign||"right";var j=this.op.config.yScaleXOffset||this.gcf.yScaleXOffset||this.paddingLeft-10;var f=this.op.config.yScaleYOffset||this.gcf.yScaleYOffset||6;var q=this.op.config.yScaleRotate||this.gcf.yScaleRotate||0;j=(this.adds.length>2)?(this.chartRight+10):j;o=(this.adds.length>2)?"left":o;var d="",i="";if(this.type==="stacked%"){d=h*10+"%"}else{if(l<=this.chartTop){this.wkYScale=this.maxY}d=this.util.addComma(this,this.wkYScale,m);i=(this.yScalePercent==="yes")?(" ("+h*10+"%)"):""}this.wkYScaleStr=d+i;this.ctx.save();if(e){this.ctx.font=e}this.ctx.fillStyle=g;this.ctx.textAlign=o;this.ctx.translate(j,l+f);this.ctx.rotate(q*2*Math.PI/360);this.ctx.fillText(this.wkYScaleStr,0,0);this.ctx.restore();this.wkYScale=parseFloat(this.wkYScale);this.wkYScale+=this.yGapValue;if(h===0){if(this.type==="scatter"){var p=(this.rowNamesTitle==="")?"":"("+this.rowNamesTitle+")";var n=this.chartLeft+-10;var k=this.chartTop+(this.chartHeight/2);if(e){this.ctx.font=e}this.ctx.fillStyle=g;this.ctx.textAlign=o;this.ctx.textAlign="center";this.ctx.translate(24,this.chartTop+(this.chartHeight/2));this.ctx.rotate(45*2*Math.PI/12);this.ctx.fillText(p,0,0)}}this.ctx.restore();return this},drawTitle:function(){if(this.title===""){return this}this.ctx.save();var h=this.title||this.gcf.title||"";var f=this.op.config.titleFont||this.gcf.titleFont||"100 28px 'Arial'";var e=this.op.config.titleTextAlign||this.gcf.titleTextAlign||"center";var g=this.op.config.titleColor||this.gcf.titleColor||this.textColor||this.textColors.all||this.textColors.title||"#ccc";var d=this.op.config.titleY||this.gcf.titleY||38;this.ctx.font=f;this.ctx.textAlign=e;this.ctx.fillStyle=g;this.ctx.fillText(h,this.width/2,d);this.ctx.restore();return this},drawSubTitle:function(){if(this.subtitle===""){return this}this.ctx.save();var h=this.subtitle||"";var f=this.op.config.subTitleFont||this.gcf.subTitleFont;var g=this.op.config.subTitleTextAlign||this.gcf.subTitleTextAlign||"center";var e=this.op.config.subTitleColor||this.gcf.subTitleColor||this.textColor||this.textColors.all||this.textColors.subTitle||"#ddd";var d=this.op.config.subTitleY||this.gcf.subTitleY||55;if(this.title===""){d=25}if(f){this.ctx.font=f}this.ctx.textAlign=g;this.ctx.fillStyle=e;this.ctx.fillText(h,this.width/2,d);this.ctx.restore();return this},drowHanrei:function(){this.ctx.save();var k=this.hanreiNames.length;var n=this.op.config.hanreiXOffset||this.gcf.hanreiXOffset||14;var f=this.op.config.hanreiYOffset||this.gcf.hanreiYOffset||40;var l=this.op.config.hanreiRadius||this.gcf.hanreiRadius||(k<10)?8:(k<20)?5:3;var q=0;if(this.type==="line"||this.type==="bezi"||this.type==="bezi2"){q=l/5;l=l-q}var r=this.op.config.hanreiLineHeight||this.gcf.hanreiLineHeight||(k<10)?20:(k<20)?14:8;var p=(k<10)?12:(k<20)?9:6;var e=this.op.config.hanreiFont||this.gcf.hanreiFont||"100 "+p+"px 'Arial'";var g=this.op.config.hanreiColor||this.gcf.hanreiColor||this.textColor||this.textColors.all||this.textColors.hanrei||"#ccc";var m=this.op.config.hanreiAlign||this.gcf.hanreiAlign||"left";var o=(this.shadows)?this.shadows.hanrei||this.shadows.all||["#222",5,5,5]:"";if(this.adds.length>=2){n=n+48}if(this.adds.length==2){f=f+(r*k)+10}for(var h=0;h<this.hanreiNames.length;h++){this.ctx.beginPath();if(this.useShadow==="yes"){this.drawShadow(o[0],o[1],o[2],o[3])}this.ctx.fillStyle=this.colorSet[h];this.ctx.strokeStyle=this.colorSet[h];if(this.hanreiMarkerStyle==="arc"){d(this)}else{j(this)}this.ctx.font=e;this.ctx.textAlign="left";this.ctx.fillStyle=g;this.ctx.fillText(this.hanreiNames[h],this.chartRight+n+l*2,this.chartBottom-(r*h)-f);this.ctx.closePath()}this.ctx.restore();function d(s){var i=s.chartRight+n;var t=s.chartBottom-(r*h)-f-4;s.ctx.arc(i,t,l,0,Math.PI*2);s.ctx.arc(i,t,l,0,Math.PI*2);s.ctx.fill();if(s.type==="line"||s.type==="bezi"||s.type==="bezi2"){s.ctx.beginPath();s.ctx.lineWidth=3;s.ctx.moveTo(i-q*2-6,t);s.ctx.lineTo(i+l*2-q*2,t);s.ctx.stroke()}}function j(s){var i=s.chartRight+n-l;var t=s.chartBottom-(r*h)-f-3-l;s.ctx.fillRect(i,t,l*2,l*2);s.ctx.fill();if(s.type==="line"||s.type==="bezi"||s.type==="bezi2"){s.ctx.lineWidth=3;s.ctx.moveTo(i-q*2,t+l);s.ctx.lineTo(i+l*2+q*2,t+l);s.ctx.stroke()}}return this},drawUnit:function(f){if(this.type==="scatter"){return}var j=navigator.language==="ja"?"単位:":"";var h=this.chartLeft-(this.op.config.unitXOffset||this.gcf.unitXOffset||10);var g=this.chartTop-(this.op.config.unitYOffset||this.gcf.unitYOffset||12);var e=this.op.config.unitColor||this.gcf.unitColor||this.textColor||this.textColors.all||this.textColors.unit||"#aaa";var d=this.op.config.unitFont||this.gcf.unitFont||"100 12px 'Arial'";var i=this.op.config.unitAlign||this.gcf.unitAlign||"right";h=(this.adds.length>2)?(this.chartRight+10):h;i=(this.adds.length>2)?"left":i;if(typeof f==="string"){this.unit=this.unit;this.drawMemo({val:"("+j+this.unit+")",left:h,top:g,align:i,color:e,font:d})}else{if(typeof f==="object"){this.unit=f.unit;this.drawMemo({val:"("+j+f.unit+")",left:f.left||h,top:f.top||g,align:f.align||"left",color:f.color||e,font:f.font||d})}}return this},drawVals:function(){if(this.useVal==="no"){return this}this.ctx.save();var m=this.valXOffset=this.op.config.valXOffset||this.gcf.valXOffset||10;var f=this.valYOffset=this.op.config.valYOffset||this.gcf.valYOffset||0;var e=this.valFont=this.op.config.valFont||this.gcf.valFont;for(var h=0;h<this.dataRowLen;h++){if(typeof this.useVal==="object"){if(this.useVal[h]==="no"){continue}}if(typeof this.valXOffset==="object"){m=this.valXOffset[h]||0}if(typeof this.valYOffset==="object"){f=this.valYOffset[h]||0}if(typeof this.valFont==="object"){e=this.valFont[h]}var i=(typeof this.valColor==="string")?this.valColor:(typeof this.valColor==="object"&&this.valColor.length>0)?this.valColor[h]:this.colorSet[h];var o=this.chartLeft;o+=this.xGap/2;for(var g=0;g<this.data[h].length;g++){var n=this.chartBottom-(this.data[h][g]-this.minY)*this.unitH;var j=this.util.mkPercentVal(this,this.data[h][g],h,g);var d=this.data[h][g];d=(this.percentVal==="yes")?j:d;this.ctx.beginPath();if(e){this.ctx.font=e}this.ctx.fillStyle=i;this.ctx.textAlign="right";this.ctx.fillText(d,o-m,n-f);o+=this.xGap}}this.ctx.restore();return this},_drawVals:function(j){var i=j.that;var g=j.row;var f=j.col;if(i.useVal==="no"){return i}i.ctx.save();i.valColor=i.op.config.valColor||i.gcf.valColor;var n=i.valXOffset=i.op.config.valXOffset||j.xoff||i.gcf.valXOffset||10;var e=i.valYOffset=i.op.config.valYOffset||j.yoff||i.gcf.valYOffset||-20;var d=i.valFont=i.op.config.valFont||j.font||i.gcf.valFont;if(typeof i.useVal==="object"){if(i.useVal[g]==="no"){return i}}if(typeof i.valXOffset==="object"){n=i.valXOffset[g]||0}if(typeof i.valYOffset==="object"){e=i.valYOffset[g]||0}if(typeof i.valFont==="object"){d=i.valFont[g]||j.font}var h=(typeof i.valColor==="string")?i.valColor:(typeof i.valColor==="object"&&i.valColor.length>0)?i.valColor[g]:j.color;val=j.val;var m=this.util.mkPercentVal(i,val,g,f);val=(i.percentVal==="yes")?m:val;if(d){i.ctx.font=d}i.ctx.fillStyle=h;i.ctx.textAlign=j.align||"right";val=val||0;j.x=j.x||0;j.y=j.y||0;i.ctx.fillText(val,j.x+n,j.y+e);i.ctx.restore();return i},drawMarkers:function(j){if(this.type==="stacked"){return}if(this.type==="pie"){return}if(this.type==="bezi2"){return}if(this.type==="bezi"){return}if(this.type==="ampli"){return}var i=this;this.ctx.save();if(!j){var j=this.op||{}}var v=j.markerWidth||this.markerWidth;var g=j.colorSet||this.colorSet;var e=(this.type==="scatter")?0:this.xGap/2;var d=0;if(this.type==="stackedarea"){var w=this.stackedData}else{if(this.type==="stacked%"){var w=this.stackedPData}else{var w=this.data}}if(this.useCss==="yes"&&this.hybridBox){var f=document.querySelector("#-ccchart-css-group-"+this.id);f.innerHTML=""}if(this.type==="scatter"){for(var s=0;s<this.dataColLen;s++){d=this.hanreiNames.indexOf(this.colNames[s]);if(d<0){d=0}var q=(w[0][s]||0)*this.unitW;var o=q+this.chartLeft-this.minX*this.unitW;var p=(w[1][s]||0)*this.unitH;var m=(this.chartBottom-(p-this.minY*this.unitH));r(o||0,m||0,0,s,w,g,d)}}else{if(this.type==="stacked"){var o=i.barPadding+i.chartLeft+i.barWidth/2;for(var u=0;u<i.dataColLen;u++){var t=0;for(var s=0;s<i.dataRowLen;s++){var m=(i.chartBottom-((i.data[s][u]||0)+t)*i.unitH)+i.barWidth/2;t=i.data[s][u];r(o,m,u,s,w,i.colorSet[u],d)}o+=i.xGap}}else{if(this.type==="bar"){var o=i.barPadding+i.chartLeft+i.barWidth/2;var n=o;var h=0;for(var u=0;u<i.dataRowLen;u++){for(var s=0;s<i.data[u].length;s++){var m=(i.chartBottom-i.data[u][s]*i.unitH)+i.barWidth/2;r(o,m,u,s,w,i.colorSet[u],d);o+=i.xGap}h+=i.barWidth+i.barGap;o=n+h}}else{for(var u=0;u<this.dataRowLen;u++){var o=this.chartLeft;o+=e;for(var s=0;s<w[u].length;s++){d=u;var p=w[u][s]*this.unitH;var m=this.chartBottom-(p-this.minY*this.unitH);r(o,m,u,s,w,g,d);o+=this.xGap}}}}}this.ctx.restore();function r(B,A,F,k,l,G,C){i.ctx.beginPath();i.ctx.fillStyle=G[C];var E=(i.type==="scatter")?l[0][k]:"";var D=(i.type==="scatter")?l[1][k]:"";if(i.useCss==="yes"&&(i.useMarker==="css-ring"||i.useMarker==="css-maru")){var z={x:B,y:A,radius:v/2,row:F,col:k,data:l[F][k],percent:i.util.mkPercentVal(i,l[F][k],F,k),scatterX:E,scatterY:D,colorIndex:C};if(i.useMarker==="css-ring"){i.css_ring(z)}else{if(i.useMarker==="css-maru"){i.css_maru(z)}}}else{i.ctx.arc(B,A,v/2,0,Math.PI*2)}i.ctx.closePath();i.ctx.fill()}return this},drawXLine:function(){var h=this.xLines;this.ctx.save();for(var g=0;g<h.length;g++){var e=h[g].font||"100 18px 'Arial'";var q=h[g].val||0;if(this.type==="line"){if(h[g].useRow!==undefined){var l=h[g].useRow||((h[g].useRow===0)?0:this.dataRowLen-1);if(l>this.dataRowLen-1||l<=0){l=0}q=(this.data[l][this.data[0].length-1])}}q=q||0;var p=h[g].color||"rgba(204,153,0,0.7)";var j=h[g].vColor||p;var k=h[g].width||1;var m=this.chartRight-(h[g].xOffset||2);var f=-(h[g].yOffset||4);var d=this.unitH*q;var o=(this.chartBottom-(d-this.minY*this.unitH))||0;var n=(this.shadows)?this.shadows.xline||this.shadows.all||["#444",7,7,5]:"";this.ctx.beginPath();this.ctx.lineWidth=k;this.ctx.strokeStyle=p;if(this.useShadow==="yes"){this.drawShadow(n[0],n[1],n[2],n[3])}this.ctx.moveTo(this.chartLeft,o);this.ctx.lineTo(this.chartRight,o);this.ctx.stroke();this.wkYScaleStr=q;this.ctx.textAlign="right";this.ctx.font=e;this.ctx.fillStyle=j;this.ctx.fillText(this.wkYScaleStr,m,o+f)}this.ctx.restore();return this},_drawLine:function(g,d){this.ctx.save();if(!g){var g=this.op||{}}var h=g.lineWidth||this.lineWidth;var n=g.colorSet||this.colorSet;var i=(this.shadows)?this.shadows.line||this.shadows.all||["#222",5,5,5]:"";for(var f=0;f<this.dataRowLen;f++){var m=this.chartLeft;m+=this.xGap/2;this.ctx.beginPath();this.ctx.lineWidth=h;this.ctx.strokeStyle=n[f];this.ctx.fillStyle=this.colorSet[f];if(this.useShadow==="yes"){if(h>1){this.drawShadow(i[0],i[1],i[2],i[3])}}if(this.type==="area"){this.ctx.moveTo(m,this.chartBottom)}for(var e=0;e<this.data[f].length;e++){var j=this.chartBottom-(this.data[f][e]-this.minY)*this.unitH;if(this.type==="area"){this.ctx.lineTo(m,j)}else{if(e===0){this.ctx.moveTo(m,j)}else{this.ctx.lineTo(m,j)}}m+=this.xGap}if(this.type==="area"){this.ctx.lineTo(m-this.xGap,this.chartBottom)}if(d){d(this)}else{this.ctx.stroke()}}this.ctx.restore();this._ondrew(this);return this},drawLine:function(d){this._drawLine(d,function(e){e.ctx.stroke()});return this},drawAmplitude:function(d){this._drawLine(d,function(e){e.ctx.fill()});return this},drawArea:function(d){this._drawLine(d,function(e){e.ctx.fill()});return this},_drawStackedArea:function(h,d){this.ctx.save();if(!h){var h=this.op||{}}var i=h.lineWidth||this.lineWidth;var q=h.colorSet||this.colorSet;var m=(this.shadows)?this.shadows.stackedarea||this.shadows.all||["#222",5,5,5]:"";var p=[];var g=[];for(var f=0;f<this.dataRowLen;f++){p[f]=[];for(var e=0;e<this.data[f].length;e++){p[f][e]=((this.data[f][e]||0)+(p[f-1]?p[f-1][e]:0));g[e]=p[f][e]}}this.stackedData=p;this.stackedPData=[];for(var f=p.length-1;f>=0;f--){var o=this.chartLeft;o+=this.xGap/2;this.ctx.beginPath();this.ctx.lineWidth=i;this.ctx.strokeStyle=q[f];this.ctx.fillStyle=q[f];if(this.useShadow==="yes"){if(this.lineWidth>1){this.drawShadow(m[0],m[1],m[2],m[3])}}this.ctx.moveTo(o,this.chartBottom);this.stackedPData[f]=[];for(var e=0;e<p[f].length;e++){var j=p[f][e]*this.unitH;if(this.type==="stacked%"){this.stackedPData[f][e]=p[f][e]*100/g[e];j=this.stackedPData[f][e]*this.unitH}var n=this.chartBottom-(j);this.ctx.lineTo(o,n);this._drawVals({that:this,val:(this.data[f][e]||0),percent:Math.round((this.data[f][e]||0)*100/g[e],10),row:f,col:e,align:"left",xoff:-10,yoff:-10,x:o,y:n});o+=this.xGap}this.ctx.lineTo(o-this.xGap,this.chartBottom);this.ctx.fill()}this.ctx.restore();this._ondrew(this);return this},drawStackedArea:function(d){this._drawStackedArea(d,function(e){});return this},drawStackedPercent:function(d){this._drawStackedArea(d,function(e){});return this},drawBar:function(){var g=this;var e=(this.shadows)?this.shadows.bar||this.shadows.all||["#222",5,5,5]:"";g.widthOfAllBar=f();if(this.widthOfAllBar>this.xGap){this.barPadding=0;this.barGap=1;this.barWidth=this.xGap/g.dataRowLen-1;d()}else{d()}this._ondrew(this);function f(){return g.barPadding+g.barWidth*g.dataRowLen+g.barGap*(g.dataRowLen-1)}function d(){h(function(n,m,j,i,o){n.ctx.fillRect(i,o,n.barWidth,n.data[m][j]*n.unitH)});h(function(n,m,j,i,o){n._drawVals({that:n,val:n.data[m][j],row:m,col:j,align:"left",xoff:2,yoff:-15,x:i,y:o})});function h(n){g.ctx.save();for(var m=0;m<g.dataRowLen;m++){var i=g.barPadding+g.chartLeft;g.ctx.beginPath();g.ctx.fillStyle=g.colorSet[m];if(g.useShadow==="yes"){g.drawShadow(e[0],e[1],e[2],e[3])}for(var j=0;j<g.data[m].length;j++){var o=(g.chartBottom-g.data[m][j]*g.unitH);n(g,m,j,i,o);i+=g.xGap}g.ctx.translate(g.barWidth+g.barGap,0)}g.ctx.restore();return this}}},drawStackedBar:function(){this.ctx.save();var h=this;var d=h.barPadding+h.chartLeft;var f=(this.shadows)?this.shadows.stacked||this.shadows.all||["#222",5,-5,5]:"";for(var g=0;g<h.dataColLen;g++){var i=0;for(var e=0;e<h.dataRowLen;e++){var j=(h.chartBottom-(h.data[e][g]||0)*h.unitH);h.ctx.beginPath();h.ctx.fillStyle=h.colorSet[e];if(h.useShadow==="yes"){h.drawShadow(f[0],f[1],f[2],f[3])}h.ctx.fillRect(d,j,h.barWidth,h.chartBottom-j);h._drawVals({that:h,color:"#eee",val:(h.data[e][g]||0),row:g,col:e,align:"left",xoff:2,yoff:-20,x:d,y:h.chartBottom+15});h.ctx.translate(0,-(h.chartBottom-j));i+=h.chartBottom-j}h.ctx.translate(0,i);d+=h.xGap}h.ctx.restore();this._ondrew(this);return this},drawbeziLine:function(){this.ctx.save();var i=0,g=0;var f=(this.shadows)?this.shadows.bezi||this.shadows.all||["#222",5,5,5]:"";for(var h=0;h<this.dataRowLen;h++){var d=this.chartLeft;d+=this.xGap/2;this.ctx.beginPath();this.ctx.lineWidth=this.lineWidth;this.ctx.strokeStyle=this.colorSet[h];if(this.useShadow==="yes"){this.drawShadow(f[0],f[1],f[2],f[3])}for(var e=0;e<this.data[h].length;e++){var j=this.chartBottom-(this.data[h][e]-this.minY)*this.unitH;if(e==0){this.ctx.moveTo(d,j)}else{this.ctx.quadraticCurveTo(i,g,d,j)}d+=this.xGap;i=d,g=j}this.ctx.stroke()}this.ctx.restore();this._ondrew(this);return this},drawbeziLine2:function(){var f=(this.shadows)?this.shadows.bezi2||this.shadows.all||["#222",5,5,5]:"";this.ctx.save();for(var g=0;g<this.dataRowLen;g++){var d=this.chartLeft;d+=this.xGap/2;this.ctx.beginPath();this.ctx.lineWidth=this.lineWidth;this.ctx.strokeStyle=this.colorSet[g];if(this.useShadow==="yes"){this.drawShadow(f[0],f[1],f[2],f[3])}for(var e=0;e<this.data[g].length;e++){var j=this.chartBottom-(this.data[g][e]-this.minY)*this.unitH;var i=d+(this.xGap)/2;var h=this.chartBottom-(((this.data[g][e+1]+this.data[g][e])/2)*this.unitH-this.minY*this.unitH);if(e==0){this.ctx.moveTo(d,j)}else{if(e==this.data[g].length-1){this.ctx.quadraticCurveTo(d,j,d,j)}else{this.ctx.quadraticCurveTo(d,j,i,h)}}d+=this.xGap}this.ctx.stroke()}this.ctx.restore();this._ondrew(this);return this},drawScatter:function(){this.ctx.save();this.drawMarkers();this.ctx.restore();this._ondrew(this);return this},drawPie:function(){this.ctx.save();var q=this;var j=(this.shadows)?this.shadows.pie||this.shadows.all||["#444",3,3,3]:"";var G=(this.op.config.pieDataIndex!=undefined)?this.op.config.pieDataIndex:(this.gcf.pieDataIndex?this.gcf.pieDataIndex:(this.dataColLen-1));if(G<0||G>(this.dataColLen-1)){G=(this.dataColLen-1)}var A=this.op.config.colNameFont||this.op.font||this.gcf.colNameFont||"100 18px 'Arial'";var J=this.util.getFontSizeFromStyle(A);var h=this.valFont=this.op.config.valFont||this.op.font||this.gcf.valFont||"100 12px 'Arial'";var w=this.util.getFontSizeFromStyle((this.op.config.subTitleFont||this.gcf.subTitleFont||"100 12px 'Arial'"));var M=this.op.config.pieXOffset||this.gcf.pieXOffset||0;var r=this.op.config.pieYOffset||this.gcf.pieYOffset||0;var s=this.chartWidth/2;var E=(this.chartHeight-w)/2;var I=20;var o=50;var f=this.pieHoleRadius;if((f>=s)||(f>=E)){d=I}f=Math.min(((f>=s)?(s-I):f),((f>=E)?(E-I):f));var d=this.pieRingWidth;var m=g(f,d);d=Math.min(((m>=s)?(s-f):d),((m>=E)?(E-f):d));m=g(f,d);var K=Math.min(this.chartHeight,this.chartWidth);var u=this.chartTop+this.chartHeight/2+r;var v=this.width/2+M;var H=[];var e=[];var n=[];var p=0,L=0;var z=2*Math.PI/360;var i=G;this.drawXscale(this.chartLeft,0);for(var D=G;D<=i;D++){H[D]=e[D]=[];deg=0;for(var B=0;B<this.dataRowLen;B++){H[D].push(this.data[B][D]||0)}e[D]=this.util.aryToDeg(H[D]);n[D]=this.util.aryToPercent(H[D]);for(var C=0;C<e[D].length;C++){p+=e[D][C];var N=H[D][C];F(v,u,m,L*z,p*z,this.colorSet[C],D,C,N);L=p}}this.ctx.restore();this._ondrew(this);function g(l,k){return l+k/2}function t(k,l){return k*2-l}function F(Y,X,O,Q,Z,S,T,R,P){q.ctx.save();q.ctx.beginPath();q.ctx.strokeStyle=q.colorSet[R];q.ctx.lineWidth=d;var W=Q+(Z-Q)/2;var ab=Y+(m+d/2+8)*Math.cos(W);var aa=X+(m+d/2+8)*Math.sin(W);var P=parseInt(P);if(q.wsuids.length===0){P=P+" ("+parseInt(n[T][R])+"%)"}q._drawVals({that:q,color:q.ctx.strokeStyle,val:P,row:T,col:R,align:(ab<Y)?"right":"left",font:h,xoff:1,yoff:5,x:ab,y:aa});try{q.ctx.arc(Y,X,m,Q,Z)}catch(V){}var U=q.colNames[T]||"";q.ctx.textAlign="center";q.ctx.fillStyle=q.textColor||q.textColors.all||"#333";q.ctx.font=A;if(t(m,d)*2<(U.length*J)){X=X+m+d/2}q.ctx.fillText(U,Y,X+J/2-2);q.ctx.stroke();q.ctx.restore()}},drawShadow:function(e,d,i,h){if(this.useShadow!=="yes"){return this}var f=navigator.userAgent.toLowerCase();var g=/(android) ([0-9])/.exec(f);if(g){i=(g[2]<4)?-i:i}this.ctx.shadowColor=e||"#222";this.ctx.shadowOffsetX=d||5;this.ctx.shadowOffsetY=i||5;this.ctx.shadowBlur=h||5;return this},flip:function(g,o,d){var j=this;var i=this.util.xbcss;var l=d?d:this.flipDirection;var h=(l==="x")?"scaleX":"scaleY";var k=parseInt(this.canvas.getAttribute("data-flipIndex"),10);if(isNaN(k)){this.flipLists=o;this.flipLists.unshift(this.op);k=1}var f=this.flipLists[k];var n=5;var e=8;m(g,f,n);if(k>=this.flipLists.length-1){k=0}else{k++}g.setAttribute("data-flipIndex",k);function m(s,r,q){var p=q;clearInterval(this.flipID);this.flipID=setInterval(function(){try{var t=p/q;if(p<=-q){clearInterval(this.flipID)}if(p>=0){s.setAttribute("style",i.enjoy(i[h](t)))}else{if(p<0){s.setAttribute("style",i.enjoy(i[h](Math.abs(t))))}}if(p===0){if(j.callback){j.init(s,r,j.callback)}else{j.init(s,r)}}p--}catch(u){clearInterval(this.flipID);console.log("err")}},e)}return this},flipX:function(e,d){this.flip(e,d,"x");return this},flipY:function(e,d){this.flip(e,d,"y");return this},move:function(f,e,d,g){if((""+f.nodeName).toLowerCase()==="canvas"){this.move1(f,e,d,g)}else{if(this.util.isArray(f)){this.move2(f,e)}}return this},ws:function(d,g){var h=this;var d=d.toLowerCase().replace(/\/$/,"");var g=g||{};g={autoReConnect:g.autoReConnect||true,maxReConnect:g.maxReConnect||8,useHb:g.useHb||true,hbStr:g.hbStr||"Heartbeat",hbInterval:g.hbInterval||null,protocol:g.protocol||"ws.ccchart.com"};var e=this.id;var i="-ccchart-ws-"+this.util.uuidv4();var l=this.wsuids[i];if(l){if(l.readyState===l.OPEN&&l.on){}else{this.wsDelTarget(l);l=k(true)}}else{l=k(true);if(h.wsDbg||h.wsInfo){console.log("init a WebSocket ","\n  canvas: #"+e,"\n  url: "+d,"\n  instance: ccchart.wsuids['"+l.op.uid+"']","\n  date: "+(new Date))}}return l;function k(n){h.wsuids[i]=h.wsRecent=new (a.WebSocket||a.MozWebSocket)(d,g.protocol);h.wsuids[i].op=g;var m="";if(n){g.autoReConnect=g.autoReConnect||true;if(h.wsReCnt["-ccchart-ws-"+e+"-"+d]===undefined){h.wsReCnt["-ccchart-ws-"+e+"-"+d]=0}if(!h.ops[e].wsReConnecting){h.wsReCnt["-ccchart-ws-"+e+"-"+d]=0}m="ws opend"}else{}h.wsuids[i].on=function(o,p){h.wsuids[i].addEventListener(o,p);return this};h.wsuids[i].op.id=e;h.wsuids[i].op.uid=i;h.wsuids[i].op.url=d;h.wsuids[i].op._noReConnectClose=function(){var o=h.wsuids[i];o.op.autoReConnect=false;if(o.readyState===o.OPEN){o.close()}};h.wsuids[i].on("open",function(){var o=h.wsuids[i];if(!o){return}if(h.wsDbg||h.wsInfo){console.log(m+": #"+e+" "+d+" "+i)}if(g.autoReConnect){if(h.wsReCnt["-ccchart-ws-"+e+"-"+d]===undefined){if(!h.ops[e].wsReConnecting){h.wsReCnt["-ccchart-ws-"+e+"-"+d]=0}}}j(o)});h.wsuids[i].on("close",function(){var q=h.wsuids[i];if(!q){return}var p="";if(h.wsDbg||h.wsInfo){if(h.ops[e].wsReConnecting){var o=h.wsReCnt["-ccchart-ws-"+e+"-"+d];var r=g.maxReConnect;p="ws wsReConnecting closed. times "+h.wsReCnt["-ccchart-ws-"+e+"-"+d]+"/"+g.maxReConnect;console.log(p+": #"+e+" "+d+" "+i);if(o===r){console.log("// Reconnected retry has ended: for #"+e+" "+d+" check the sever");h.ops[e].wsReConnecting=false}}else{p="ws closd--";console.log(p+": #"+e+" "+d+" "+i)}}if(h.wsDbg){if(q){console.log(2,e,"autoReConnect:",g.autoReConnect);console.log(2,'that.ops["'+e+'"].wsReConnecting: ',h.ops[e].wsReConnecting);console.log(2,"wsReCnt: ",h.wsReCnt["-ccchart-ws-"+e+"-"+d],h.wsReCnt);console.log(2,"ws closed: #"+e+" "+d+" "+i)}}f(q)});return h.wsuids[i]}function f(o){if(!o){return}if(!g.autoReConnect){h.wsDelTarget(o);return}if(g.maxReConnect<=h.wsReCnt["-ccchart-ws-"+e+"-"+d]){g.autoReConnect=false;h.ops[e].wsReConnecting=false}else{h.ops[e].wsReConnecting=true}if(g.autoReConnect===false){return}h.wsReCnt["-ccchart-ws-"+e+"-"+d]++;if(h.wsDbg||h.wsInfo){var n=h.wsReCnt["-ccchart-ws-"+e+"-"+d];var p=g.maxReConnect;openinfo="ws retry to open. times "+n+"/"+p;console.log(openinfo+": #"+e+" "+d)}h.init(e,h.ops[e].op,h.ops[e].ondrew);var m=h.ws(d,g);m.on("message",ccchart.wscase.oneColAtATime);if(h.wsDbg){console.log(h.op.id,("-ccchart-ws-"+e+"-"+d),m)}return m}function j(o){if(!g.useHb){return}var m=5000;var n=60000;g.hbInterval=(typeof g.hbInterval==="number")?(g.hbInterval>=m)?g.hbInterval:n:n;o.on("message",function(r){try{var p=JSON.parse(r.data)}catch(q){return}if(p===o.op.hbStr){o.op.bncEnd=(new Date).getTime();o.op.RTT=((o.op.bncEnd-o.op.bncStart)||" - ");if(h.wsDbg||h.wsInfo){console.log("Heartbeat returned: RTT",o.op.RTT+"ms",p,"#"+e,i)}return}return});clearInterval(o.op.hbTimer);o.op.hbTimer=setInterval(function(){o.op.bncStart=(new Date).getTime();o.send(o.op.hbStr);if(h.wsDbg){console.log("Heartbeat send:","#"+e,d,("\n  readyState: "+o.readyState),("\n  hbInterval: "+g.hbInterval),("\n  instance: ccchart.wsuids['"+i+"']"),("\n  date: "+(new Date)))}},g.hbInterval)}},wsDelTarget:function(d){if(d.readyState===d.OPEN){d.op._noReConnectClose()}clearInterval(d.op.hbTimer);delete this.wsuids[d.op.uid];delete d;return this},getWs:function(d){if(!d){return}return this.wsuids[d]},_wsOnClose:function(f,e){var d=this;if(!f){return}f.on("close",function(){if(d.wsDbg){console.log(e+" \n id: #"+thatget.op.id+" \n url: "+url)}d.wsDelTarget(f)});f.op._noReConnectClose();return this},wsCloseByUid:function(d){if(!d){return}if(!this.wsuids){return}var e=this.wsuids[d];if(!e){return}this._wsOnClose(e,"this closed was by the wsCloseByUid. ")},wsCloseById:function(f){if(!f){return}if(!this.wsuids){return}for(var d in this.wsuids){var e=this.wsuids[d];if(!e){continue}if(e.op.id===f){this._wsOnClose(e,"this closed was by the wsCloseById. ")}}},wsCloseByUrl:function(d){if(!d){return}if(!this.wsuids){return}for(var e in this.wsuids){var f=this.wsuids[e];var g=f.op.url.toLowerCase().replace(/\/$/,"");var d=d.toLowerCase().replace(/\/$/,"");if(!f){continue}if(g===d){this._wsOnClose(f,"this closed was by the wsCloseByUrl. ")}}},wsCloseByIdUrl:function(h,d){if(!h){return}if(!d){return}if(!this.wsuids){return}for(var e in this.wsuids){var f=this.wsuids[e];var g=f.op.url.toLowerCase().replace(/\/$/,"");var d=d.toLowerCase().replace(/\/$/,"");if(!f){continue}if(g===d){this._wsOnClose(f,"this closed was by the wsCloseByIdUrl. ")}}},wsClose:function(g,d){var e=this;if(!g){return}if(!d){return}var f=this.wsuids["-ccchart-ws-"+g+"-"+d];if(!f){return}f.on("close",function(h){if(e.wsDbg){console.log("this closed was by the wsClose method: "+h.target.op.url)}e.wsDelTarget(h.target)});f.op._noReConnectClose();return this},wsCloseAll:function(){var e=this;if(!this.wsuids){return}for(var d in this.wsuids){var f=this.wsuids[d];if(!f){continue}f.on("close",function(g){if(e.wsDbg){console.log("this closed was by the wsCloseAll method: "+g.target.op.url)}e.wsDelTarget(g.target)});f.op._noReConnectClose()}return this},wscase:{oneColAtATime:function(l){try{var j=JSON.parse(l.data)}catch(k){return}if(typeof j==="string"){if(this.wsDbg){console.log("ws message type is bad, it is string : "+j)}return}var h=ccchart.ops[this.op.id];if(h.wsThrowData){var d=(h.ops[h.id]["e"]-h.ops[h.id]["s"]);if(d>h.maxDelayMS){if(h.wsInfo){console.log(h.id,(", Chart type: "+h.type),(", Delayed: "+d),"\n  i threw away the following data. ","\n  Data: "+JSON.stringify(j),"\n  Date: "+(new Date))}h.ops[h.id]["s"]=h.ops[h.id]["e"]=0;j=h=d=null;return}if(h.drawing){console.log("I threw away the data: ",JSON.stringify(j));return}}for(var f=0;f<j.length;f++){if(!h.op.data[f]){continue}var g=h.op.data[f].shift();h.op.data[f].push(j[f]);if(h.op.data[f].length>h.maxWsColLen){h.op.data[f].shift()}h.op.data[f].unshift(g)}if(h.type==="pie"){h.op.config.maxWsColLen=1}h.ops[h.id]["s"]=(new Date).getTime();ccchart.init(h.id,h.op,function(){h.ops[h.id].e=(new Date).getTime()})},someColsAtATime:function(m){try{var k=JSON.parse(m.data)}catch(l){return}var h=ccchart.ops[this.op.id];if(h.drawing){console.log("I threw away the data: ",JSON.stringify(k));return}for(var d=0;d<k.length;d++){for(var f=0;f<k[d].length;f++){var g=h.op.data[f].shift();h.op.data[f].push(k[d][f]);if(h.op.data[f].length>h.maxWsColLen){h.op.data[f].shift()}h.op.data[f].unshift(g)}}ccchart.init(h.id,h.op);if(h.callback){ccchart.init(h.id,h.op,h.callback)}else{ccchart.init(h.id,h.op)}}},move1:function(l,g,k,f){console.log("調整中");return;var j=this;var d=(f!==undefined)?f:100;var e=this.util.isArray(g);var h=0;clearInterval(this.moveTid);this.moveTid=setInterval(function(){try{if(h<k.length-1){h++;var m={config:(e)?g[h]:g,data:k[h]};j.init(l,m)}else{clearInterval(this.moveTid)}}catch(i){clearInterval(this.moveTid)}},d);return this},move2:function(k,g){console.log("調整中");return;var h=this;if(!k){return this}if(this.moveStack.length===0){if(!this.moveIntOpData){this.moveIntOpData=JSON.stringify(this.op.data);if(this.useFirstToRowName){this.moveIntRowNames=this.rowNames}}else{if(this.moveIntOpData!==this.op.data){this.moveDly=0;this.moveStack=[];this.moveStackDly=[];this.op.data=JSON.parse(this.moveIntOpData)}}}var n=g||200;this.moveDly+=n;var m=this.op.config;var j=this.op.data;for(var f=0;f<j.length;f++){j[f].shift();j[f].shift();j[f].push(k[f]);j[f].unshift(this.moveIntRowNames[f-1]);if(f===j.length-1){this.moveStack.push(JSON.stringify(j))}}this.moveStackDly.push(this.moveDly);if(this.moveStack.length===0){l(h)}else{var e=setTimeout(function(){clearTimeout(e);l(h)},this.moveStackDly.shift())}function l(d){var i=JSON.parse(d.moveStack.shift());d.init({config:m,data:i})}return this},drawImg:function(d){if(!d){var d=this._img||[]}if(!this.util.isArray(d)){return}if(typeof d[0]==="string"){this.drawImgs(d)}else{if(this.util.isArray(d[0])){for(var e=0;e<d.length;e++){this.drawImgs(d[e])}}}},drawImgs:function(o){if(!o){var o=this._img||[]}var e=o[0]||"";if(e===""){return this}var i=o.length;var h=this;var l,k,m,g,p,n,d,j;var f=new Image();f.canvasId=this.id;f.src=e;f.onload=function(q){h.currImgTargetCtx=h.cxs[this.canvasId];h.currImgTargetCtx.globalAlpha=h.ops[this.canvasId].imgAlpha;h.ctx.save();if(i===1){p=0;n=0;d=h.width;j=h.height;h.currImgTargetCtx.drawImage(f,p,n,d,j)}else{if(i<=3){p=o[1]||0;n=o[2]||0;h.currImgTargetCtx.drawImage(f,p,n)}else{if(i<=5){p=o[1]||0;n=o[2]||0;d=o[3]||0;j=o[4]||0;h.currImgTargetCtx.drawImage(f,p,n,d,j)}else{if(i<=9){l=o[1]||0;k=o[2]||0;m=o[3]||0;g=o[4]||0;p=o[5]||0;n=o[6]||0;d=o[7]||0;j=o[8]||0;h.currImgTargetCtx.drawImage(f,l,k,m,g,p,n,d,j)}}}}h.ctx.restore()}},drawMemo:function(l){this.ctx.save();if(!l){var l=this._memo||{}}var f=l.val||"";var j=l.left||0;var q=l.top||0;var h=l.lineTo||false;var k=l.lineTo2||false;if(!(f&&((j&&q)||h||k))){return this}var g=l.font||"100 14px 'Arial'";var e=l.align||"left";var s=l.color||this.textColor||this.textColors.all||this.textColors.memo||"#ccc";if(this.util.isArray(h)){if(h.length===2){var i=(typeof l.lineToXOffset==="number")?l.lineToXOffset:50;var p=(typeof l.lineToYOffset==="number")?l.lineToYOffset:3;var r=(typeof l.lineToWidth==="number")?l.lineToWidth:1;var d=l.lineToColor||s}else{h=false}}else{h=false}this.ctx.font=g;this.ctx.textAlign=e;this.ctx.fillStyle=s;this.ctx.fillText(f,j,q);if(h){var n=this;o(decodeURIComponent(m(this.id,"rowNames",h[0])),decodeURIComponent(m(this.id,"colNames",h[1])))}this.ctx.restore();return this;function o(v,u){var t=n.chartLeft+n.xGap/2+n.xGap*u;var w=n.chartBottom-(n.data[v][u]-n.minY)*n.unitH;n.ctx.save();n.ctx.beginPath();n.ctx.lineWidth=r;n.ctx.strokeStyle=d;n.ctx.moveTo(j+i,q+p);n.ctx.lineTo(t,w);n.ctx.stroke();n.ctx.restore()}function m(w,v,u){for(var t=0;t<n.ops[w][v].length;t++){if(""+n.ops[w][v][t]===""+u){return t}}}},toData:function(d){var f,e;if(typeof d!=="object"){f="image/png";e=this.canvas}else{f=(d.type)?d.type:"image/png";if((""+d.canvas.nodeName).toLowerCase()==="canvas"){e=d.canvas}else{e=document.getElementById(d.canvas)}}return e.toDataURL(f)},add:function(f,e){var d=this;this.adds.push([this.id,f,e]);this.init(this.adds[0][0],this.adds[0][1],this.adds[0][2]);this.adds.push([this.id,f,e]);this.preProcessing(f,e);d.adds=undefined;return this},line:function(d){this.drawLine(d);return this},markers:function(d){this.drawMarkers(d);return this},memo:function(d){this.drawMemo(d);return this},setOp:function(e,d){return this.ops[this.id][e]=this[e]=d},extend:function(f,g){if(!g){g=f;f=this}if(!g.aboutThis_module){g.aboutThis_module={name:"module_"+(new Date()).getTime()}}for(var e in g){if(e==="aboutThis_module"){var d=g[e]["name"]||"module_"+(new Date()).getTime();f.aboutThis["module"][g[e].name]=g[e]}if(e==="init"){}else{f[e]=g[e]}}return f},loadBranch:function(h,g){var f=(typeof h==="string");var d=(typeof h.config==="string");var e=(typeof h.data==="string");if(f){this.getOption(h,g,true)}else{if(e||d){if(e&&d){this.getOptionCnfData(h,g,true)}else{if(d){this.getOptionCnf(h,g,true)}else{if(e){this.getOptionData(h,g,true)}}}}else{if(this.util.isArray(h.data)){this.preProcessing(h,g)}}}},base:function b(){var g=this;var h=arguments.length;var j="";if(h===0){this.gcf={};d(g.m.theme._default||{})}else{if(h===1){if(!this.gcf){this.gcf={}}j=this.util.cnfExtend({config:this.gcf},k(arguments[0]));d(j)}else{var l="";for(var e=0;e<h;e++){var m=arguments[e];if(m===""||m===null){this.gcf={};continue}l=k(arguments[e]);j=this.util.cnfExtend({config:this.gcf},l);d(j)}}}for(var e in this.ids){var f=this.ids[e];this.init(f,this.ops[f.id].op,this.ops[f.id].callback)}return this;function k(n){var i;var n=n?n:"_default";if(typeof n==="string"){i=g.m.theme[n]||{}}else{if(typeof n==="object"){if(!n.config){return g}i=n||{}}}return i}function d(i){g.gcf=i.config;g.gdata=i.data||[[""],[""]];return g}},toggleRC:function(f,e,d){var e=e;e.data=this.util.changeRowsAndCols(e.data);this.init(this.id,e,d);return this},util:{getValWidth:function(e,g,f){if(typeof g==="number"){var d=Math.floor(Math.log(g)/Math.log(10))+1;return d*f}else{if(typeof g==="string"){return g.length*f}}return 5*this.getCurrFontSize(e)},setDefaultCtxProps:function(d,f,e){d.ctx[f]=d.cxs[d.id][f]=e;return d.ctx},getCurrFontSize:function(d){var e=d.ctx.font;if(typeof e!=="string"){return 12}return +e.match(/(\d*)px/)[1]},changeRowsAndCols:function(f){var d=[];for(var e=0;e<f.length;e++){for(var g=0;g<f[e].length;g++){if(!d[g]){d[g]=[]}d[g].push(f[e][g])}}return d},uuidv4:function(){var e="",d,f;for(d=0;d<32;d++){f=Math.random()*16|0;if(d==8||d==12||d==16||d==20){e+="-"}e+=(d==12?4:(d==16?(f&3|8):f)).toString(16)}return e},cnfExtend:function(h,e){var g=f(h);return d(g,e);function f(i){return JSON.parse(JSON.stringify(i))}function d(m,j){for(var k in j){var l=j[k];if(k==="config"||k==="data"){if(typeof l==="object"&&!ccchart.util.isArray(l)){d(m[k],l)}else{m[k]=l}}else{m[k]=l}}return m}},uniq:function(e){var d=null;var f=[];e.sort().forEach(function(g,j,h){if(g===null){return}if(d!==g){f.push(g)}d=g});return f},addComma:function(h,k,l){if(isNaN(parseFloat(k))){return k}var g="";var e="";var d=".";if(l==="yes"){g=ccchart.util.round00(k,h.roundDigit);e=g.split(d)[1];g=g.split(d)[0]}else{g+=parseInt(k);d=""}var j=g.charAt(0);j=(j==="-"||j==="+")?j:"";g=(j==="")?g:g.substr(1);for(var f=3;f<g.length;f+=4){g=g.substring(0,g.length-f)+","+g.substring(g.length-f)}e=isNaN(e)?"":d+e;return j+g+e},round00:function(h,j){var e=Math.pow(10,j);var i=parseFloat(h);var g=""+Math.round(i*e)/e;if(j<=0){return g}var f=d(j);if(g.indexOf(".")<0){return g+"."+f}else{g=g+f;return g.split(".")[0]+"."+g.split(".")[1].substring(0,j)}function d(m){var l="";for(var k=0;k<m;k++){l=l+"0"}return l}},getMax:function(d){return this._preGetMinMax(d).sort(function(f,e){return e-f})[0]},getMin:function(d){return this._preGetMinMax(d).sort(function(f,e){return f-e})[0]},_preGetMinMax:function(h){var g=[];for(var f=0;f<h.dataRowLen;f++){var e=[];for(var d=0;d<h.data[f].length;d++){if(!(h.data[f][d]===null||h.data[f][d]===undefined)){e=e.concat(h.data[f][d])}}g=g.concat(e)}return g},mkPercentVal:function(g,i,f,e){var d=g.util.getSumCols(g);var h=Math.round(i*100/d[f],10)+"%";if(g.type==="stacked"){h=Math.round(i*100/d[f],10)+"%"}else{if(g.type==="pie"){if(g.wsuids.length===0){h=i}else{h=i+" ("+Math.round(i*100/d[e])+"%)"}}else{h=Math.round(i*100/d[e],10)+"%"}}return h},getSumCols:function(h){var e=[];var g=[];for(var f=0;f<h.dataRowLen;f++){e[f]=[];for(var d=0;d<h.data[f].length;d++){e[f][d]=((h.data[f][d]||0)+(e[f-1]?e[f-1][d]:0));g[d]=e[f][d]}}return g},getMaxSum:function(h){var f=[];var g=0;for(var e=0;e<h.dataColLen;e++){for(var d=0;d<h.dataRowLen;d++){if(h.data[d][e]){g+=parseFloat(h.data[d][e])}}f.push(g);g=0}return f.sort(function(j,i){return i-j})[0]},aryToPercent:function(f){var e=0,d=[];f.forEach(function(g,h){e+=(g||0)});f.forEach(function(g,h){d.push(((g||0)/e)*100)});return d},aryToDeg:function(f){var d=[];var e=this.aryToPercent(f);e.forEach(function(g,h){d.push((g/100)*360)});return d},isMobile:function(){var e=navigator.userAgent.toLowerCase();var d=/(android|iphone|ipad|iemobile)/.exec(e);return d?d[0]:null},isArray:function(d){if(typeof d==="object"&&d.length>=0){return true}return Object.prototype.toString.call(d).toLowerCase()==="[object array]"},bGgradient:function(f,e,d){var d=d||"left";return";;background-image:-webkit-gradient(linear, "+d+" top, "+d+" bottom, color-stop(0, "+f+"), color-stop(.5, "+e+"));background-image:-webkit-linear-gradient("+d+", "+f+" 0%, "+e+" 50%);background-image:-moz-linear-gradient("+d+", "+f+" 0%, "+e+" 50%);background-image:-ms-linear-gradient("+d+", "+f+" 0%, "+e+" 50%);background-image:-o-linear-gradient("+d+", "+f+" 0%, "+e+" 50%);"},setBG:function(e,h,g,f){if(e.nodeType===1){e.style.cssText=ccchart.util.bGgradient(h,g,f)}else{if(e.length>0){for(var d=0;d<e.length;d++){e[d].style.cssText=ccchart.util.bGgradient(h,g,f)}}}},getFontSizeFromStyle:function(e){var d=(e).split(" ")[1]||0;return parseFloat(d)},hCopy:function(d){return JSON.parse(JSON.stringify(d))},xbcss:{enjoy:function(){var d=this.enjoy.arguments;if(!this[d[0].split("(")[0]]){return}var h={transform:document.body.style.transform,"-webkit-transform":document.body.style.webkitTransform,"-moz-transform":document.body.style.MozTransform,"-ms-transform":document.body.style.msTransform,"-o-transform":document.body.style.OTransform};var g="";for(var f in h){if(h[f]!==undefined){g=f+":";for(var e=0;e<d.length;e++){g+=" "+d[e]}}}return g},translate:function(f,e){var d=(e)?(f+","+e):(f+", 0px");return"translate("+d+") "},translateX:function(d){return"translateX("+d+")"},translateY:function(d){return"translateY("+d+")"},scale:function(e,d){var d=(d)?d:e;return"scale("+e+","+d+")"},scaleX:function(d){return"scaleX("+d+")"},scaleY:function(d){return"scaleY("+d+")"},skew:function(f,e){var d=(e)?(f+","+e):f;return"skew("+d+")"},skewX:function(d){return"skewX("+d+")"},skewY:function(d){return"skewY("+d+")"},matrix:function(h,f,j,i,g,e){return"matrix("+h+","+f+","+j+","+i+","+g+","+e+")"},matrix3d:function(s,r,p,n,k,j,i,h,g,f,e,d,q,o,m,l){return"matrix3d("+s+","+r+","+p+","+n+","+k+","+j+","+i+","+h+","+g+","+f+","+e+","+d+","+q+","+o+","+m+","+l+")"},rotate:function(d){return"rotate("+d+"deg)"}}}}})(window);window.ccchart.m.cssHybrid=(function(window){return{aboutThis_module:{name:"cssHybrid",varsion:"0.04",update:20120610,lisence:"Public Domain",demo:"http://ccchart.com/",writer:"Toshiro Takahashi @toshirot",see:"http://www.facebook.com/javascripting",branched:"This is module for ccchart(canvasChart) v0.919+http://ccchart.com/"},useCssSetting:function(){if(this.useCss!=="yes"){return this}if(this.type==="pie"){return this}var id=this.id;var that=this;var style=getComputedStyle(this.canvas);var top=getNum("top");var left=getNum("left");var marginTop=getNum("margin-top");var marginLeft=getNum("margin-left");var paddingTop=getNum("padding-top");var paddingLeft=getNum("padding-left");var borderTopWidth=getNum("border-top-width");var borderLeftWidth=getNum("border-left-width");var currZindex=getNum("z-index");var position=style.position;var position=(position==="relative"||position==="static")?"absolute":position;this.maxZindex=(this.maxZindex<currZindex)?currZindex:this.maxZindex;var operaTop=(this.ua.match(/opera/)&&position==="fixed")?(getNum("top")+Math.max(getNum("margin"),getNum("margin-top"))):0;var operaLeft=(this.ua.match(/opera/)&&position==="fixed")?(getNum("left")+Math.max(getNum("margin"),getNum("margin-left"))):0;this.ops[this.id]["adjustTop"]=paddingTop+borderTopWidth+operaTop;this.ops[this.id]["adjustLeft"]=paddingLeft+borderLeftWidth+operaLeft;this.ops[this.id].TMP_tooltipIni=";position: absolute;top: -10000px;left: -10000px";this.ops[this.id].TMP_tooltip=";width:120px;height:40px;box-shadow: 6px 6px 6px rgba(000,000,000,0.6), inset 2px 2px 3px 3px rgba(180,180,180,0.2);border: 1px solid rgba(180,180,180,0.7);border-radius: 12px;font-size: 10px;line-height: 11px;padding-top: 5px;text-align: center;text-shadow: 0px;";this.ops[this.id].TMP_tooltip_fukidashi='{;content: " ";position: absolute;z-index: 2;left: 20px;top: 45px;background: transparent;border : 12px solid;border-color: rgba(200,200,200,0.9) transparent transparent;}';var cssText="";this.hybridCssEl=document.querySelector("#-ccchart-css-styles");this.hybridCss=getHybridCss();if(this.hybridCssEl===null){this.hybridCssEl=document.createElement("style");this.hybridCssEl.setAttribute("id","-ccchart-css-styles");this.hybridCssEl.setAttribute("title","-ccchart-css-styles");cssText+="\n.-ccchart-css-arc{background-color: rgba(0,0,0,0.5);}";cssText+="\ndiv.-ccchart-css-arc:hover{";cssText+="  box-shadow: 0px 0px 30px rgba(255,255,255,1);";cssText+="  background-color: rgba(255,255,255,0.5);";cssText+="}";cssText+="\n.line{border-top: 1px solid #000;}";cssText+="\ndiv.line:hover{";cssText+="  box-shadow: 0px 0px 30px rgba(255,255,255,1);";cssText+="  background-color: rgba(255,255,255,0.5);";cssText+="}";cssText+="\n\n"}this.cssTooltip=this.op.config.cssTooltip||this.gcf.cssTooltip||"";this.cssTooltipFukidashi=this.op.config.cssTooltipFukidashi||this.ops[this.id].TMP_tooltip_fukidashi;if(!this.cssgs[this.id]){if(!(this.op.config.cssTooltip||this.gcf.cssTooltip)){cssText+="\n.-ccchart-css-tooltip {"+this.ops[this.id].TMP_tooltipIni+"}";cssText+="\n #-ccchart-css-tooltip-"+this.id+"{"+this.ops[this.id].TMP_tooltip+"}"}else{var css="";if(typeof this.cssTooltip==="object"){css="{";for(var i in this.cssTooltip){css+=";"+i+":"+this.cssTooltip[i]}css+="}"}else{if(typeof this.cssTooltip==="string"){css+=this.cssTooltip}}cssText+="\n.-ccchart-css-tooltip {"+this.ops[this.id].TMP_tooltipIni+"}";cssText+="\n #-ccchart-css-tooltip-"+this.id+(css)}cssText+="\n.-ccchart-css-tooltip:before "+this.cssTooltipFukidashi}this.hybridCssEl.innerHTML+=cssText;document.head.appendChild(this.hybridCssEl);cssText="";this.hybridCssEl=null;this.hybridCss=document.styleSheets[0];this.hybridBox=document.querySelector("#-ccchart-css-hybrid");if(this.hybridBox===null){var hybridBox=document.createElement("div");hybridBox.setAttribute("id","-ccchart-css-hybrid");this.hybridBox=document.body.appendChild(hybridBox)}this.cssgs[id]=document.querySelector("#-ccchart-css-group-"+id);if(!this.cssgs[id]){var cssGrpBox=document.getElementById("-ccchart-css-groupbox");var cssGrpBox=cssGrpBox?cssGrpBox:document.createElement("div");cssGrpBox.setAttribute("id","-ccchart-css-groupbox");var cssGrp=document.createElement("div");cssGrp.setAttribute("class","-ccchart-css-group");this.hybridBox.appendChild(cssGrpBox);this.cssgs[id]=cssGrpBox.appendChild(cssGrp);this.cssgs[id].setAttribute("id","-ccchart-css-group-"+id);cssGrpBox=null}var cssText="";cssText+=";width:"+getCvsVal("width",this.width)+"px";cssText+=";height:"+getCvsVal("height",this.height)+"px";cssText+=";position:"+position;if(position==="fixed"){var fixedZ=this.maxZindex+2;cssText+=";z-index:"+(""+fixedZ);this.canvas.style.zIndex=(""+fixedZ)}else{cssText+=";z-index:"+(this.maxZindex+1)}this.cssgs[id].setAttribute("style",cssText+";background:transparent;border-color:transparent;");if(this.useToolTip==="yes"){addToolTip(this)}return this;function addToolTip(that){var id=that.id;that.cssTooltips[id]=document.querySelector("#-ccchart-css-tooltip-"+id);if(!that.cssTooltips[id]){var csstooltip=document.createElement("div");csstooltip.setAttribute("class","-ccchart-css-tooltip");csstooltip.setAttribute("id","-ccchart-css-tooltip-"+id);var cssText="";cssText+=";z-index:"+(that.maxZindex+1);setTimeout(function(){that.cssTooltips[id]=that.cssgs[id].appendChild(csstooltip);try{var _tooltipop=that.cssTooltip;if(_tooltipop){if(!_tooltipop.bgGradient){defaultToolTipBG(id)}else{that.util.setBG(document.querySelectorAll("#-ccchart-css-tooltip-"+id),_tooltipop.bgGradient.from,_tooltipop.bgGradient.to,"top")}}else{defaultToolTipBG(id)}}catch(e){}},0)}}function defaultToolTipBG(id){that.util.setBG(document.querySelectorAll("#-ccchart-css-tooltip-"+id),"rgba(200,200,200,0.6)","rgba(255,255,255,0.6)","top")}function getHybridCss(){var sheet=null;for(var i=0;i<document.styleSheets.length;i++){if(document.styleSheets[i].title==="-ccchart-css-styles"){sheet=document.styleSheets[i]}break}return sheet}function getCvsVal(prop,defaultVal){return that.canvas.style[prop]||that.canvas.getAttribute(prop)||defaultVal}function getComputedStyle(elm){return elm.currentStyle||document.defaultView.getComputedStyle(elm,"")}function getNum(prop){return parseFloat(document.defaultView.getComputedStyle(that.canvas,"").getPropertyValue(prop),10)||0}},adjustCss:function(type){var that=this;for(var i in this.ops){if(that.ops[i].useCss!=="yes"){continue}var el=document.getElementById(i);var level=0;var group=document.getElementById("-ccchart-css-group-"+i);if(!group){return}getPos(i,el,level,10,0,0,function(numAry){var topOff=that.ops[i]["adjustTop"];var leftOff=that.ops[i]["adjustLeft"];var top=topOff+numAry[0]||0;var left=leftOff+numAry[1]||0;group.style.top=top+"px";group.style.left=left+"px"})}function getPos(id,el,level,deep,numT,numL,fn){var current=el.nodeName.toUpperCase();if(current==="BODY"){return}if(!deep){var deep=5}var css=el.currentStyle||document.defaultView.getComputedStyle(el,"");var parentoffNode=el.offsetParent||el.parentNode;if(!parentoffNode){return}if(css){if(!that.ops[id].targetPos){that.ops[id].targetPos=css.position}if(that.ops[id].targetPos==="fixed"){if(current==="CANVAS"){numT+=el.offsetTop;numL+=el.offsetLeft}}else{if(that.ops[id].targetPos==="static"||that.ops[id].targetPos==="relative"||that.ops[id].targetPos==="absolute"){if(current==="CAPTION"||current==="TD"||current==="TH"||current==="TABLE"){var borderTopW=parseInt(css.borderTopWidth,10);var borderLeftW=parseInt(css.borderLeftWidth,10);var syusei=that.ua.match(/firefox/)?2:1;numT+=el.offsetTop+borderTopW/syusei;numL+=el.offsetLeft+borderLeftW/syusei}else{numT+=el.offsetTop;numL+=el.offsetLeft}}else{}}if(parentoffNode.nodeName.toUpperCase()==="BODY"){if(fn){fn([numT,numL])}}else{getPos(id,parentoffNode,++level,deep,numT,numL,fn)}delete css}}},_css_arc:function(op){var that=this;var id=this.id;if(!op){var op=this.op||{}}var x=op.x||0;var y=op.y||0;var radius=op.radius||5;var borderWidth=this.borderWidth||3;var borderColor=op.borderColor||op.colorSet||this.colorSet;var colorIndex=((this.type==="scatter")?op.colorIndex:op.row)||0;var bgcolor=op.bgColor||this.colorSet[colorIndex]||this.colorSet[colorIndex];var tipBgcolor=bgcolor;if((this.type==="bar"||this.type==="stacked")&&this.useToolTip==="yes"){bgcolor=(this.barTipAnchorColor==="colorSet")?bgcolor:this.barTipAnchorColor}var etc=(op.etcStyle?op.etcStyle:"");var el=document.createElement("div");if(borderWidth>radius){radius=borderWidth}var dataX=(this.type==="scatter")?(this.rowNames[0]):this.colNames[op.col];var dataY=(this.type==="scatter")?(this.rowNames[1]):this.rowNames[op.row];var unit=that.ops[id].unit;if(typeof unit==="string"){unit=unit}else{if(typeof unit==="object"){unit=unit.unit}}if((this.dataRowLen-1)===op.row&&(this.dataColLen-1)===op.col){this.adjustCss("adjusting");var _cnt=0;var _tid=setInterval(function(){if(_cnt>=5){clearInterval(_tid)}that.adjustCss("adjusting");_cnt++},200)}el.setAttribute("class","-ccchart-css-arc "+op.classStr);el.setAttribute("data-row",op.row);el.setAttribute("data-col",op.col);el.setAttribute("data-colname",this.colNames[op.col]);el.setAttribute("data-colnamestitle",this.colNamesTitle);el.setAttribute("data-y",dataY);el.setAttribute("data-x",dataX);el.setAttribute("data-scatter-y",op.scatterY);el.setAttribute("data-scatter-x",op.scatterX);el.setAttribute("data-data",op.data);el.setAttribute("data-percent",op.percent);el.setAttribute("data-unit",op.unit);el.setAttribute("data-bg",tipBgcolor);var xyr="position: absolute;left:"+(x-radius)+"px;top:"+(y-radius)+"px;width:"+radius*2+"px;height:"+radius*2+"px;border-radius:"+radius*2+"px;"+((this.type==="bar")?"opacity: 0.5;":"")+((op.classStr==="css-maru")?("background: "+bgcolor+";"):"")+((op.classStr==="css-ring")?("border:"+borderWidth+"px solid "+borderColor+";"):"")+"box-sizing: border-box;"+this.pfx["transform-origin"]+": 0px 0px;"+this.pfx["box-sizing"]+": border-box;"+this.pfx.transition+": background-color 200ms linear";el.setAttribute("style",xyr+etc);var arc=this.cssgs[id].appendChild(el);el=null;function showTooltip(id,e,op){that.csstoolRock=true;var rowNum=e.target.getAttribute("data-row");var rowName=e.target.getAttribute("data-y");var colName=e.target.getAttribute("data-x");var scatterXData=e.target.getAttribute("data-scatter-x");var scatterYData=e.target.getAttribute("data-scatter-y");var colname=e.target.getAttribute("data-colname");var colnamestitle=e.target.getAttribute("data-colnamestitle");var data=e.target.getAttribute("data-data");var percent=(that.percentVal==="yes")?"( "+e.target.getAttribute("data-percent")+" )":"";var unit=e.target.getAttribute("data-unit");var bgcolor=e.target.getAttribute("data-bg");var colNamesTitle=(that.type==="scatter")?colname:((that.colNamesTitle)?that.colNamesTitle:"");var unit=that.ops[id].unit;if(typeof unit==="string"){unit=unit}else{if(typeof unit==="object"){unit=unit.unit}}var toolTemp=!that.ops[id].tmpToolTip?"":that.ops[id].tmpToolTip;toolTemp=toolTemp.replace(/{{colNamesTitle}}/g,'<span class="-ccchart-ttip-colnamestitle">'+colNamesTitle+"</span> ").replace(/{{colName}}/g,'<span class="-ccchart-ttip-colname">'+colName+"</span>").replace(/{{rowName}}/g,'<span class="-ccchart-ttip-rowname">'+rowName+"</span>").replace(/{{data}}/g,'<span class="-ccchart-ttip-data">'+data+"</span>").replace(/{{unit}}/g,'<span class="-ccchart-ttip-unit">'+unit+"</span>").replace(/{{percent}}/g,'<span class="-ccchart-ttip-percent">'+percent+"</span>");var re=/{{(\w*)}}/g;var res=[];var other=[];while(res=re.exec(toolTemp)){try{var _other=eval(res[1]);if(typeof _other==="object"){toolTemp=toolTemp.replace("{{"+RegExp.$1+"}}",'<span class="-ccchart-ttip-'+res[1]+'">'+_other[(op.row+1)][(op.col+1)]+"</span>")}}catch(e){}}var computedStyle=document.defaultView.getComputedStyle(that.cssTooltips[id],"");setTimeout(function(){if(!computedStyle){return}var height=parseFloat(computedStyle.getPropertyValue("height"),10)||0;var borderTop=parseFloat(computedStyle.getPropertyValue("border-top"),10)||0;var borderBottom=parseFloat(computedStyle.getPropertyValue("border-bottom"),10)||0;var paddingTop=parseFloat(computedStyle.getPropertyValue("padding-top"),10)||0;var paddingBottom=parseFloat(computedStyle.getPropertyValue("padding-bottom"),10)||0;computedStyle=null;that.cssTooltips[id].style.left=(x-radius-20)+"px";that.cssTooltips[id].style.top=(y-radius-70-height)+"px";that.hybridCss.insertRule("#-ccchart-css-tooltip-"+id+":before {top:"+((borderBottom+paddingTop+paddingBottom)+height)+"px}")},0);if(that.type==="scatter"){var htm='<span class="-ccchart-ttip-sct-colnamestitle">'+colNamesTitle+'</span><br><span class="-ccchart-ttip-sct-colname">'+colName+'</span> <span class="-ccchart-ttip-sct-data-x">'+scatterXData+'</span><br><span class="-ccchart-ttip-sct-rowname">'+rowName+'</span> <span class="-ccchart-ttip-sct-data-y">'+scatterYData+"</span><br>";that.cssTooltips[id].innerHTML=htm}else{var htm='<span class="-ccchart-ttip-colnamestitle">'+colNamesTitle+'</span> <span class="-ccchart-ttip-colname">'+colName+'</span><br><span class="-ccchart-ttip-rowname">'+rowName+'</span><br><span class="-ccchart-ttip-data">'+data+"</span>"+(" "+unit+""||"")+'<span class="-ccchart-ttip-percent"> '+percent+" </span>";if(that.cssTooltips[id]){that.cssTooltips[id].innerHTML=toolTemp||htm}toolTemp=htm=""}that.deleteCssRule("#-ccchart-css-tooltip-"+id+"::before");that.hybridCss.insertRule("#-ccchart-css-tooltip-"+id+":before{ border-color:"+bgcolor+" transparent transparent;}",that.hybridCss.cssRules.length);clearTimeout(this._ttId);this._ttId=setTimeout(function(){that.csstoolRock=false},1500)}function hideTooltip(id){if(!that.csstoolRock&&that.cssTooltips[id]){that.cssTooltips[id].style.left=-10000+"px";that.cssTooltips[id].style.top=-10000+"px";that.cssTooltips[id].innerHTML=""}}if(this.useToolTip==="yes"){var mbl=this.util.isMobile();var over=(mbl)?"touchstart":"mouseover";var out=(mbl)?"touchend":"mouseout";arc.addEventListener(over,function(e){showTooltip(id,e,op)});arc.addEventListener(out,function(){setTimeout(function(){if(!that.csstoolRock){hideTooltip(id)}},500)});arc.addEventListener("dblclick",function(){if(that.csstoolRock){that.csstoolRock=false}else{that.csstoolRock=true}})}return el},css_ring:function(op){op.classStr="css-ring";if(this.type!=="scatter"){op.borderColor=op.borderColor||this.colorSet[op.row]}this._css_arc(op)},css_maru:function(op){op.classStr="css-maru";if(this.type!=="scatter"){op.bgColor=op.bgColor||this.colorSet[op.row]}this._css_arc(op)},css_lineTo:function(op){op.classStr="css_lineTo";op.bgColor=op.bgColor||this.colorSet[op.row]},deleteCssRule:function(selectorText){for(var i=0;i<this.hybridCss.cssRules.length;i++){if(this.hybridCss.cssRules[i].selectorText===selectorText){this.hybridCss.deleteRule(i)}}}}})(window);window.ccchart.m.theme={white:{config:{bg:"#fff",colorSet:["red","#FF9114","#3CB000","#00A8A2","#0036C0","#C328FF","#FF34C0"],xColor:"rgba(180,180,180,0.3)",yColor:"rgba(180,180,180,0.3)",textColors:{title:"#777",subTitle:"#777",x:"#999",y:"#999",hanrei:"#777",unit:"#777",memo:"#666"},shadows:{hanrei:["#ccc",5,5,5],xline:["#ccc",7,7,5],line:["#ccc",5,5,5],bar:["#ccc",5,5,5],stacked:["#ccc",5,-5,5],stackedarea:["#ccc",5,5,5],bezi:["#ccc",5,5,5],bezi2:["#ccc",5,5,5]}}},black:{config:{bg:"#000",colorSet:["red","#FF9114","#3CB000","#00A8A2","#0036C0","#C328FF","#FF34C0"],xColor:"rgba(180,180,180,0.6)",yColor:"rgba(180,180,180,0.6)",textColors:{title:"#777",subTitle:"#777",x:"#999",y:"#999",hanrei:"#777",unit:"#777",memo:"#666"},shadows:{hanrei:["#222",5,5,5],xline:["#222",7,7,5],line:["#222",5,5,5],bar:["#222",5,5,5],stacked:["#222",5,-5,5],stackedarea:["#222",5,5,5],bezi:["#222",5,5,5],bezi2:["#222",5,5,5],scatter:["#222",5,5,5],pie:["#222",5,5,5]}}},_default:{config:{lineWidth:2,bgGradient:{direction:"vertical",from:"#687478",to:"#222"},xColor:"rgba(180,180,180,0.3)",yColor:"rgba(180,180,180,0.3)",colorSet:["red","#FF9114","#3CB000","#00A8A2","#0036C0","#C328FF","#FF34C0"],textColors:{title:"#ccc",subTitle:"#ddd",x:"#aaa",y:"#aaa",hanrei:"#ccc",unit:"#aaa",memo:"#ccc"},shadows:{hanrei:["#222",5,5,5],xline:["#444",7,7,5],line:["#222",5,5,5],bar:["#222",5,5,5],stacked:["#222",5,-5,5],stackedarea:["#222",5,5,5],bezi:["#222",5,5,5],bezi2:["#222",5,5,5],scatter:["#222",5,5,5],pie:["#222",5,5,5]}}},set:function(a){var b=ccchart.util.cnfExtend(this.white);b.config.bg=a;return b}};